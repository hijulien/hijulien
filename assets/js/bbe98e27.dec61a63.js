"use strict";(self.webpackChunkhijulien=self.webpackChunkhijulien||[]).push([[9263],{3905:(e,n,t)=>{t.d(n,{Zo:()=>k,kt:()=>m});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},p=Object.keys(e);for(r=0;r<p.length;r++)t=p[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(r=0;r<p.length;r++)t=p[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=r.createContext({}),s=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},k=function(e){var n=s(e.components);return r.createElement(i.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,p=e.originalType,i=e.parentName,k=l(e,["components","mdxType","originalType","parentName"]),c=s(t),d=a,m=c["".concat(i,".").concat(d)]||c[d]||u[d]||p;return t?r.createElement(m,o(o({ref:n},k),{},{components:t})):r.createElement(m,o({ref:n},k))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var p=t.length,o=new Array(p);o[0]=d;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l[c]="string"==typeof e?e:a,o[1]=l;for(var s=2;s<p;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},83197:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>p,metadata:()=>l,toc:()=>s});var r=t(87462),a=(t(67294),t(3905));const p={},o="Proxy",l={unversionedId:"ES6/proxy",id:"ES6/proxy",title:"Proxy",description:"\u6982\u8ff0",source:"@site/frontend/ES6/proxy.md",sourceDirName:"ES6",slug:"/ES6/proxy",permalink:"/hijulien/frontend/ES6/proxy",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"front",previous:{title:"Mixin",permalink:"/hijulien/frontend/ES6/mixin"},next:{title:"Reflect",permalink:"/hijulien/frontend/ES6/reflect"}},i={},s=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"Proxy \u5b9e\u4f8b\u7684\u65b9\u6cd5",id:"proxy-\u5b9e\u4f8b\u7684\u65b9\u6cd5",level:2},{value:"get()",id:"get",level:3},{value:"set()",id:"set",level:3},{value:"apply()",id:"apply",level:3},{value:"has()",id:"has",level:3},{value:"construct()",id:"construct",level:3},{value:"deleteProperty()",id:"deleteproperty",level:3},{value:"defineProperty()",id:"defineproperty",level:3},{value:"getOwnPropertyDescriptor()",id:"getownpropertydescriptor",level:3},{value:"getPrototypeOf()",id:"getprototypeof",level:3},{value:"isExtensible()",id:"isextensible",level:3},{value:"ownKeys()",id:"ownkeys",level:3},{value:"preventExtensions()",id:"preventextensions",level:3},{value:"setPrototypeOf()",id:"setprototypeof",level:3},{value:"Proxy.revocable()",id:"proxyrevocable",level:2},{value:"this \u95ee\u9898",id:"this-\u95ee\u9898",level:2},{value:"\u5b9e\u4f8b\uff1aWeb \u670d\u52a1\u7684\u5ba2\u6237\u7aef",id:"\u5b9e\u4f8bweb-\u670d\u52a1\u7684\u5ba2\u6237\u7aef",level:2}],k={toc:s},c="wrapper";function u(e){let{components:n,...t}=e;return(0,a.kt)(c,(0,r.Z)({},k,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"proxy"},"Proxy"),(0,a.kt)("h2",{id:"\u6982\u8ff0"},"\u6982\u8ff0"),(0,a.kt)("p",null,"Proxy \u7528\u4e8e\u4fee\u6539\u67d0\u4e9b\u64cd\u4f5c\u7684\u9ed8\u8ba4\u884c\u4e3a\uff0c\u7b49\u540c\u4e8e\u5728\u8bed\u8a00\u5c42\u9762\u505a\u51fa\u4fee\u6539\uff0c\u6240\u4ee5\u5c5e\u4e8e\u4e00\u79cd\u201c\u5143\u7f16\u7a0b\u201d\uff08meta programming\uff09\uff0c\u5373\u5bf9\u7f16\u7a0b\u8bed\u8a00\u8fdb\u884c\u7f16\u7a0b\u3002"),(0,a.kt)("p",null,"Proxy \u53ef\u4ee5\u7406\u89e3\u6210\uff0c\u5728\u76ee\u6807\u5bf9\u8c61\u4e4b\u524d\u67b6\u8bbe\u4e00\u5c42\u201c\u62e6\u622a\u201d\uff0c\u5916\u754c\u5bf9\u8be5\u5bf9\u8c61\u7684\u8bbf\u95ee\uff0c\u90fd\u5fc5\u987b\u5148\u901a\u8fc7\u8fd9\u5c42\u62e6\u622a\uff0c\u56e0\u6b64\u63d0\u4f9b\u4e86\u4e00\u79cd\u673a\u5236\uff0c\u53ef\u4ee5\u5bf9\u5916\u754c\u7684\u8bbf\u95ee\u8fdb\u884c\u8fc7\u6ee4\u548c\u6539\u5199\u3002Proxy \u8fd9\u4e2a\u8bcd\u7684\u539f\u610f\u662f\u4ee3\u7406\uff0c\u7528\u5728\u8fd9\u91cc\u8868\u793a\u7531\u5b83\u6765\u201c\u4ee3\u7406\u201d\u67d0\u4e9b\u64cd\u4f5c\uff0c\u53ef\u4ee5\u8bd1\u4e3a\u201c\u4ee3\u7406\u5668\u201d\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var obj = new Proxy({}, {\n  get: function (target, propKey, receiver) {\n    console.log(`getting ${propKey}!`);\n    return Reflect.get(target, propKey, receiver);\n  },\n  set: function (target, propKey, value, receiver) {\n    console.log(`setting ${propKey}!`);\n    return Reflect.set(target, propKey, value, receiver);\n  }\n});\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u5bf9\u4e00\u4e2a\u7a7a\u5bf9\u8c61\u67b6\u8bbe\u4e86\u4e00\u5c42\u62e6\u622a\uff0c\u91cd\u5b9a\u4e49\u4e86\u5c5e\u6027\u7684\u8bfb\u53d6\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\uff09\u548c\u8bbe\u7f6e\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\uff09\u884c\u4e3a\u3002\u8fd9\u91cc\u6682\u65f6\u5148\u4e0d\u89e3\u91ca\u5177\u4f53\u7684\u8bed\u6cd5\uff0c\u53ea\u770b\u8fd0\u884c\u7ed3\u679c\u3002\u5bf9\u8bbe\u7f6e\u4e86\u62e6\u622a\u884c\u4e3a\u7684\u5bf9\u8c61",(0,a.kt)("inlineCode",{parentName:"p"},"obj"),"\uff0c\u53bb\u8bfb\u5199\u5b83\u7684\u5c5e\u6027\uff0c\u5c31\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u7ed3\u679c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"obj.count = 1\n//  setting count!\n++obj.count\n//  getting count!\n//  setting count!\n//  2\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u8bf4\u660e\uff0cProxy \u5b9e\u9645\u4e0a\u91cd\u8f7d\uff08overload\uff09\u4e86\u70b9\u8fd0\u7b97\u7b26\uff0c\u5373\u7528\u81ea\u5df1\u7684\u5b9a\u4e49\u8986\u76d6\u4e86\u8bed\u8a00\u7684\u539f\u59cb\u5b9a\u4e49\u3002"),(0,a.kt)("p",null,"ES6 \u539f\u751f\u63d0\u4f9b Proxy \u6784\u9020\u51fd\u6570\uff0c\u7528\u6765\u751f\u6210 Proxy \u5b9e\u4f8b\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var proxy = new Proxy(target, handler);\n")),(0,a.kt)("p",null,"Proxy \u5bf9\u8c61\u7684\u6240\u6709\u7528\u6cd5\uff0c\u90fd\u662f\u4e0a\u9762\u8fd9\u79cd\u5f62\u5f0f\uff0c\u4e0d\u540c\u7684\u53ea\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"handler"),"\u53c2\u6570\u7684\u5199\u6cd5\u3002\u5176\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"new Proxy()"),"\u8868\u793a\u751f\u6210\u4e00\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"Proxy"),"\u5b9e\u4f8b\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"target"),"\u53c2\u6570\u8868\u793a\u6240\u8981\u62e6\u622a\u7684\u76ee\u6807\u5bf9\u8c61\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"handler"),"\u53c2\u6570\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u7528\u6765\u5b9a\u5236\u62e6\u622a\u884c\u4e3a\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u53e6\u4e00\u4e2a\u62e6\u622a\u8bfb\u53d6\u5c5e\u6027\u884c\u4e3a\u7684\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var proxy = new Proxy({}, {\n  get: function(target, propKey) {\n    return 35;\n  }\n});\n\nproxy.time // 35\nproxy.name // 35\nproxy.title // 35\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"Proxy"),"\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u3002\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6240\u8981\u4ee3\u7406\u7684\u76ee\u6807\u5bf9\u8c61\uff08\u4e0a\u4f8b\u662f\u4e00\u4e2a\u7a7a\u5bf9\u8c61\uff09\uff0c\u5373\u5982\u679c\u6ca1\u6709",(0,a.kt)("inlineCode",{parentName:"p"},"Proxy"),"\u7684\u4ecb\u5165\uff0c\u64cd\u4f5c\u539f\u6765\u8981\u8bbf\u95ee\u7684\u5c31\u662f\u8fd9\u4e2a\u5bf9\u8c61\uff1b\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u914d\u7f6e\u5bf9\u8c61\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u88ab\u4ee3\u7406\u7684\u64cd\u4f5c\uff0c\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u5bf9\u5e94\u7684\u5904\u7406\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u5c06\u62e6\u622a\u5bf9\u5e94\u7684\u64cd\u4f5c\u3002\u6bd4\u5982\uff0c\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u914d\u7f6e\u5bf9\u8c61\u6709\u4e00\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\u65b9\u6cd5\uff0c\u7528\u6765\u62e6\u622a\u5bf9\u76ee\u6807\u5bf9\u8c61\u5c5e\u6027\u7684\u8bbf\u95ee\u8bf7\u6c42\u3002",(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\u65b9\u6cd5\u7684\u4e24\u4e2a\u53c2\u6570\u5206\u522b\u662f\u76ee\u6807\u5bf9\u8c61\u548c\u6240\u8981\u8bbf\u95ee\u7684\u5c5e\u6027\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u7531\u4e8e\u62e6\u622a\u51fd\u6570\u603b\u662f\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"35"),"\uff0c\u6240\u4ee5\u8bbf\u95ee\u4efb\u4f55\u5c5e\u6027\u90fd\u5f97\u5230",(0,a.kt)("inlineCode",{parentName:"p"},"35"),"\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c\u8981\u4f7f\u5f97",(0,a.kt)("inlineCode",{parentName:"p"},"Proxy"),"\u8d77\u4f5c\u7528\uff0c\u5fc5\u987b\u9488\u5bf9",(0,a.kt)("inlineCode",{parentName:"p"},"Proxy"),"\u5b9e\u4f8b\uff08\u4e0a\u4f8b\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u5bf9\u8c61\uff09\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u4e0d\u662f\u9488\u5bf9\u76ee\u6807\u5bf9\u8c61\uff08\u4e0a\u4f8b\u662f\u7a7a\u5bf9\u8c61\uff09\u8fdb\u884c\u64cd\u4f5c\u3002"),(0,a.kt)("p",null,"\u5982\u679c",(0,a.kt)("inlineCode",{parentName:"p"},"handler"),"\u6ca1\u6709\u8bbe\u7f6e\u4efb\u4f55\u62e6\u622a\uff0c\u90a3\u5c31\u7b49\u540c\u4e8e\u76f4\u63a5\u901a\u5411\u539f\u5bf9\u8c61\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var target = {};\nvar handler = {};\nvar proxy = new Proxy(target, handler);\nproxy.a = 'b';\ntarget.a // \"b\"\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"handler"),"\u662f\u4e00\u4e2a\u7a7a\u5bf9\u8c61\uff0c\u6ca1\u6709\u4efb\u4f55\u62e6\u622a\u6548\u679c\uff0c\u8bbf\u95ee",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u5c31\u7b49\u540c\u4e8e\u8bbf\u95ee",(0,a.kt)("inlineCode",{parentName:"p"},"target"),"\u3002"),(0,a.kt)("p",null,"\u4e00\u4e2a\u6280\u5de7\u662f\u5c06 Proxy \u5bf9\u8c61\uff0c\u8bbe\u7f6e\u5230",(0,a.kt)("inlineCode",{parentName:"p"},"object.proxy"),"\u5c5e\u6027\uff0c\u4ece\u800c\u53ef\u4ee5\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"object"),"\u5bf9\u8c61\u4e0a\u8c03\u7528\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var object = { proxy: new Proxy(target, handler) };\n")),(0,a.kt)("p",null,"Proxy \u5b9e\u4f8b\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u5bf9\u8c61\u7684\u539f\u578b\u5bf9\u8c61\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var proxy = new Proxy({}, {\n  get: function(target, propKey) {\n    return 35;\n  }\n});\n\nlet obj = Object.create(proxy);\nobj.time // 35\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u5bf9\u8c61\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"obj"),"\u5bf9\u8c61\u7684\u539f\u578b\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"obj"),"\u5bf9\u8c61\u672c\u8eab\u5e76\u6ca1\u6709",(0,a.kt)("inlineCode",{parentName:"p"},"time"),"\u5c5e\u6027\uff0c\u6240\u4ee5\u6839\u636e\u539f\u578b\u94fe\uff0c\u4f1a\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u5bf9\u8c61\u4e0a\u8bfb\u53d6\u8be5\u5c5e\u6027\uff0c\u5bfc\u81f4\u88ab\u62e6\u622a\u3002"),(0,a.kt)("p",null,"\u540c\u4e00\u4e2a\u62e6\u622a\u5668\u51fd\u6570\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u62e6\u622a\u591a\u4e2a\u64cd\u4f5c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var handler = {\n  get: function(target, name) {\n    if (name === 'prototype') {\n      return Object.prototype;\n    }\n    return 'Hello, ' + name;\n  },\n\n  apply: function(target, thisBinding, args) {\n    return args[0];\n  },\n\n  construct: function(target, args) {\n    return {value: args[1]};\n  }\n};\n\nvar fproxy = new Proxy(function(x, y) {\n  return x + y;\n}, handler);\n\nfproxy(1, 2) // 1\nnew fproxy(1, 2) // {value: 2}\nfproxy.prototype === Object.prototype // true\nfproxy.foo === \"Hello, foo\" // true\n")),(0,a.kt)("p",null,"\u5bf9\u4e8e\u53ef\u4ee5\u8bbe\u7f6e\u3001\u4f46\u6ca1\u6709\u8bbe\u7f6e\u62e6\u622a\u7684\u64cd\u4f5c\uff0c\u5219\u76f4\u63a5\u843d\u5728\u76ee\u6807\u5bf9\u8c61\u4e0a\uff0c\u6309\u7167\u539f\u5148\u7684\u65b9\u5f0f\u4ea7\u751f\u7ed3\u679c\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u662f Proxy \u652f\u6301\u7684\u62e6\u622a\u64cd\u4f5c\u4e00\u89c8\uff0c\u4e00\u5171 13 \u79cd\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"get(target, propKey, receiver)"),"\uff1a\u62e6\u622a\u5bf9\u8c61\u5c5e\u6027\u7684\u8bfb\u53d6\uff0c\u6bd4\u5982",(0,a.kt)("inlineCode",{parentName:"li"},"proxy.foo"),"\u548c",(0,a.kt)("inlineCode",{parentName:"li"},"proxy['foo']"),"\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"set(target, propKey, value, receiver)"),"\uff1a\u62e6\u622a\u5bf9\u8c61\u5c5e\u6027\u7684\u8bbe\u7f6e\uff0c\u6bd4\u5982",(0,a.kt)("inlineCode",{parentName:"li"},"proxy.foo = v"),"\u6216",(0,a.kt)("inlineCode",{parentName:"li"},"proxy['foo'] = v"),"\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"has(target, propKey)"),"\uff1a\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"li"},"propKey in proxy"),"\u7684\u64cd\u4f5c\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"deleteProperty(target, propKey)"),"\uff1a\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"li"},"delete proxy[propKey]"),"\u7684\u64cd\u4f5c\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"ownKeys(target)"),"\uff1a\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"li"},"Object.getOwnPropertyNames(proxy)"),"\u3001",(0,a.kt)("inlineCode",{parentName:"li"},"Object.getOwnPropertySymbols(proxy)"),"\u3001",(0,a.kt)("inlineCode",{parentName:"li"},"Object.keys(proxy)"),"\u3001",(0,a.kt)("inlineCode",{parentName:"li"},"for...in"),"\u5faa\u73af\uff0c\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\u3002\u8be5\u65b9\u6cd5\u8fd4\u56de\u76ee\u6807\u5bf9\u8c61\u6240\u6709\u81ea\u8eab\u7684\u5c5e\u6027\u7684\u5c5e\u6027\u540d\uff0c\u800c",(0,a.kt)("inlineCode",{parentName:"li"},"Object.keys()"),"\u7684\u8fd4\u56de\u7ed3\u679c\u4ec5\u5305\u62ec\u76ee\u6807\u5bf9\u8c61\u81ea\u8eab\u7684\u53ef\u904d\u5386\u5c5e\u6027\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"getOwnPropertyDescriptor(target, propKey)"),"\uff1a\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"li"},"Object.getOwnPropertyDescriptor(proxy, propKey)"),"\uff0c\u8fd4\u56de\u5c5e\u6027\u7684\u63cf\u8ff0\u5bf9\u8c61\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"defineProperty(target, propKey, propDesc)"),"\uff1a\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"li"},"Object.defineProperty(proxy, propKey, propDesc\uff09"),"\u3001",(0,a.kt)("inlineCode",{parentName:"li"},"Object.defineProperties(proxy, propDescs)"),"\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"preventExtensions(target)"),"\uff1a\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"li"},"Object.preventExtensions(proxy)"),"\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"getPrototypeOf(target)"),"\uff1a\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"li"},"Object.getPrototypeOf(proxy)"),"\uff0c\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"isExtensible(target)"),"\uff1a\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"li"},"Object.isExtensible(proxy)"),"\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"setPrototypeOf(target, proto)"),"\uff1a\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"li"},"Object.setPrototypeOf(proxy, proto)"),"\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u662f\u51fd\u6570\uff0c\u90a3\u4e48\u8fd8\u6709\u4e24\u79cd\u989d\u5916\u64cd\u4f5c\u53ef\u4ee5\u62e6\u622a\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"apply(target, object, args)"),"\uff1a\u62e6\u622a Proxy \u5b9e\u4f8b\u4f5c\u4e3a\u51fd\u6570\u8c03\u7528\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982",(0,a.kt)("inlineCode",{parentName:"li"},"proxy(...args)"),"\u3001",(0,a.kt)("inlineCode",{parentName:"li"},"proxy.call(object, ...args)"),"\u3001",(0,a.kt)("inlineCode",{parentName:"li"},"proxy.apply(...)"),"\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"construct(target, args)"),"\uff1a\u62e6\u622a Proxy \u5b9e\u4f8b\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u8c03\u7528\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982",(0,a.kt)("inlineCode",{parentName:"li"},"new proxy(...args)"),"\u3002")),(0,a.kt)("h2",{id:"proxy-\u5b9e\u4f8b\u7684\u65b9\u6cd5"},"Proxy \u5b9e\u4f8b\u7684\u65b9\u6cd5"),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u4e0a\u9762\u8fd9\u4e9b\u62e6\u622a\u65b9\u6cd5\u7684\u8be6\u7ec6\u4ecb\u7ecd\u3002"),(0,a.kt)("h3",{id:"get"},"get()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\u65b9\u6cd5\u7528\u4e8e\u62e6\u622a\u67d0\u4e2a\u5c5e\u6027\u7684\u8bfb\u53d6\u64cd\u4f5c\uff0c\u53ef\u4ee5\u63a5\u53d7\u4e09\u4e2a\u53c2\u6570\uff0c\u4f9d\u6b21\u4e3a\u76ee\u6807\u5bf9\u8c61\u3001\u5c5e\u6027\u540d\u548c proxy \u5b9e\u4f8b\u672c\u8eab\uff08\u4e25\u683c\u5730\u8bf4\uff0c\u662f\u64cd\u4f5c\u884c\u4e3a\u6240\u9488\u5bf9\u7684\u5bf9\u8c61\uff09\uff0c\u5176\u4e2d\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u53ef\u9009\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\u65b9\u6cd5\u7684\u7528\u6cd5\uff0c\u4e0a\u6587\u5df2\u7ecf\u6709\u4e00\u4e2a\u4f8b\u5b50\uff0c\u4e0b\u9762\u662f\u53e6\u4e00\u4e2a\u62e6\u622a\u8bfb\u53d6\u64cd\u4f5c\u7684\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'var person = {\n  name: "\u5f20\u4e09"\n};\n\nvar proxy = new Proxy(person, {\n  get: function(target, propKey) {\n    if (propKey in target) {\n      return target[propKey];\n    } else {\n      throw new ReferenceError("Prop name \\"" + propKey + "\\" does not exist.");\n    }\n  }\n});\n\nproxy.name // "\u5f20\u4e09"\nproxy.age // \u629b\u51fa\u4e00\u4e2a\u9519\u8bef\n')),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u8868\u793a\uff0c\u5982\u679c\u8bbf\u95ee\u76ee\u6807\u5bf9\u8c61\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\uff0c\u4f1a\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u62e6\u622a\u51fd\u6570\uff0c\u8bbf\u95ee\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\uff0c\u53ea\u4f1a\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"undefined"),"\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\u65b9\u6cd5\u53ef\u4ee5\u7ee7\u627f\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"let proto = new Proxy({}, {\n  get(target, propertyKey, receiver) {\n    console.log('GET ' + propertyKey);\n    return target[propertyKey];\n  }\n});\n\nlet obj = Object.create(proto);\nobj.foo // \"GET foo\"\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u62e6\u622a\u64cd\u4f5c\u5b9a\u4e49\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"Prototype"),"\u5bf9\u8c61\u4e0a\u9762\uff0c\u6240\u4ee5\u5982\u679c\u8bfb\u53d6",(0,a.kt)("inlineCode",{parentName:"p"},"obj"),"\u5bf9\u8c61\u7ee7\u627f\u7684\u5c5e\u6027\u65f6\uff0c\u62e6\u622a\u4f1a\u751f\u6548\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u7684\u4f8b\u5b50\u4f7f\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\u62e6\u622a\uff0c\u5b9e\u73b0\u6570\u7ec4\u8bfb\u53d6\u8d1f\u6570\u7684\u7d22\u5f15\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"function createArray(...elements) {\n  let handler = {\n    get(target, propKey, receiver) {\n      let index = Number(propKey);\n      if (index < 0) {\n        propKey = String(target.length + index);\n      }\n      return Reflect.get(target, propKey, receiver);\n    }\n  };\n\n  let target = [];\n  target.push(...elements);\n  return new Proxy(target, handler);\n}\n\nlet arr = createArray('a', 'b', 'c');\narr[-1] // c\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u6570\u7ec4\u7684\u4f4d\u7f6e\u53c2\u6570\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"-1"),"\uff0c\u5c31\u4f1a\u8f93\u51fa\u6570\u7ec4\u7684\u5012\u6570\u7b2c\u4e00\u4e2a\u6210\u5458\u3002"),(0,a.kt)("p",null,"\u5229\u7528 Proxy\uff0c\u53ef\u4ee5\u5c06\u8bfb\u53d6\u5c5e\u6027\u7684\u64cd\u4f5c\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\uff09\uff0c\u8f6c\u53d8\u4e3a\u6267\u884c\u67d0\u4e2a\u51fd\u6570\uff0c\u4ece\u800c\u5b9e\u73b0\u5c5e\u6027\u7684\u94fe\u5f0f\u64cd\u4f5c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'var pipe = function (value) {\n  var funcStack = [];\n  var oproxy = new Proxy({} , {\n    get : function (pipeObject, fnName) {\n      if (fnName === \'get\') {\n        return funcStack.reduce(function (val, fn) {\n          return fn(val);\n        },value);\n      }\n      funcStack.push(window[fnName]);\n      return oproxy;\n    }\n  });\n\n  return oproxy;\n}\n\nvar double = n => n * 2;\nvar pow    = n => n * n;\nvar reverseInt = n => n.toString().split("").reverse().join("") | 0;\n\npipe(3).double.pow.reverseInt.get; // 63\n')),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u8bbe\u7f6e Proxy \u4ee5\u540e\uff0c\u8fbe\u5230\u4e86\u5c06\u51fd\u6570\u540d\u94fe\u5f0f\u4f7f\u7528\u7684\u6548\u679c\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u7684\u4f8b\u5b50\u5219\u662f\u5229\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\u62e6\u622a\uff0c\u5b9e\u73b0\u4e00\u4e2a\u751f\u6210\u5404\u79cd DOM \u8282\u70b9\u7684\u901a\u7528\u51fd\u6570",(0,a.kt)("inlineCode",{parentName:"p"},"dom"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const dom = new Proxy({}, {\n  get(target, property) {\n    return function(attrs = {}, ...children) {\n      const el = document.createElement(property);\n      for (let prop of Object.keys(attrs)) {\n        el.setAttribute(prop, attrs[prop]);\n      }\n      for (let child of children) {\n        if (typeof child === 'string') {\n          child = document.createTextNode(child);\n        }\n        el.appendChild(child);\n      }\n      return el;\n    }\n  }\n});\n\nconst el = dom.div({},\n  'Hello, my name is ',\n  dom.a({href: '//example.com'}, 'Mark'),\n  '. I like:',\n  dom.ul({},\n    dom.li({}, 'The web'),\n    dom.li({}, 'Food'),\n    dom.li({}, '\u2026actually that\\'s it')\n  )\n);\n\ndocument.body.appendChild(el);\n")),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\u65b9\u6cd5\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\u7684\u4f8b\u5b50\uff0c\u5b83\u603b\u662f\u6307\u5411\u539f\u59cb\u7684\u8bfb\u64cd\u4f5c\u6240\u5728\u7684\u90a3\u4e2a\u5bf9\u8c61\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u5c31\u662f Proxy \u5b9e\u4f8b\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const proxy = new Proxy({}, {\n  get: function(target, key, receiver) {\n    return receiver;\n  }\n});\nproxy.getReceiver === proxy // true\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u5bf9\u8c61\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"getReceiver"),"\u5c5e\u6027\u4f1a\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"get()"),"\u62e6\u622a\uff0c\u5f97\u5230\u7684\u8fd4\u56de\u503c\u5c31\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u5bf9\u8c61\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const proxy = new Proxy({}, {\n  get: function(target, key, receiver) {\n    return receiver;\n  }\n});\n\nconst d = Object.create(proxy);\nd.a === d // true\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"d"),"\u5bf9\u8c61\u672c\u8eab\u6ca1\u6709",(0,a.kt)("inlineCode",{parentName:"p"},"a"),"\u5c5e\u6027\uff0c\u6240\u4ee5\u8bfb\u53d6",(0,a.kt)("inlineCode",{parentName:"p"},"d.a"),"\u7684\u65f6\u5019\uff0c\u4f1a\u53bb",(0,a.kt)("inlineCode",{parentName:"p"},"d"),"\u7684\u539f\u578b",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u5bf9\u8c61\u627e\u3002\u8fd9\u65f6\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"receiver"),"\u5c31\u6307\u5411",(0,a.kt)("inlineCode",{parentName:"p"},"d"),"\uff0c\u4ee3\u8868\u539f\u59cb\u7684\u8bfb\u64cd\u4f5c\u6240\u5728\u7684\u90a3\u4e2a\u5bf9\u8c61\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u4e00\u4e2a\u5c5e\u6027\u4e0d\u53ef\u914d\u7f6e\uff08configurable\uff09\u4e14\u4e0d\u53ef\u5199\uff08writable\uff09\uff0c\u5219 Proxy \u4e0d\u80fd\u4fee\u6539\u8be5\u5c5e\u6027\uff0c\u5426\u5219\u901a\u8fc7 Proxy \u5bf9\u8c61\u8bbf\u95ee\u8be5\u5c5e\u6027\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const target = Object.defineProperties({}, {\n  foo: {\n    value: 123,\n    writable: false,\n    configurable: false\n  },\n});\n\nconst handler = {\n  get(target, propKey) {\n    return 'abc';\n  }\n};\n\nconst proxy = new Proxy(target, handler);\n\nproxy.foo\n// TypeError: Invariant check failed\n")),(0,a.kt)("h3",{id:"set"},"set()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u65b9\u6cd5\u7528\u6765\u62e6\u622a\u67d0\u4e2a\u5c5e\u6027\u7684\u8d4b\u503c\u64cd\u4f5c\uff0c\u53ef\u4ee5\u63a5\u53d7\u56db\u4e2a\u53c2\u6570\uff0c\u4f9d\u6b21\u4e3a\u76ee\u6807\u5bf9\u8c61\u3001\u5c5e\u6027\u540d\u3001\u5c5e\u6027\u503c\u548c Proxy \u5b9e\u4f8b\u672c\u8eab\uff0c\u5176\u4e2d\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u53ef\u9009\u3002"),(0,a.kt)("p",null,"\u5047\u5b9a",(0,a.kt)("inlineCode",{parentName:"p"},"Person"),"\u5bf9\u8c61\u6709\u4e00\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"age"),"\u5c5e\u6027\uff0c\u8be5\u5c5e\u6027\u5e94\u8be5\u662f\u4e00\u4e2a\u4e0d\u5927\u4e8e 200 \u7684\u6574\u6570\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"Proxy"),"\u4fdd\u8bc1",(0,a.kt)("inlineCode",{parentName:"p"},"age"),"\u7684\u5c5e\u6027\u503c\u7b26\u5408\u8981\u6c42\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"let validator = {\n  set: function(obj, prop, value) {\n    if (prop === 'age') {\n      if (!Number.isInteger(value)) {\n        throw new TypeError('The age is not an integer');\n      }\n      if (value > 200) {\n        throw new RangeError('The age seems invalid');\n      }\n    }\n\n    // \u5bf9\u4e8e\u6ee1\u8db3\u6761\u4ef6\u7684 age \u5c5e\u6027\u4ee5\u53ca\u5176\u4ed6\u5c5e\u6027\uff0c\u76f4\u63a5\u4fdd\u5b58\n    obj[prop] = value;\n    return true;\n  }\n};\n\nlet person = new Proxy({}, validator);\n\nperson.age = 100;\n\nperson.age // 100\nperson.age = 'young' // \u62a5\u9519\nperson.age = 300 // \u62a5\u9519\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u7531\u4e8e\u8bbe\u7f6e\u4e86\u5b58\u503c\u51fd\u6570",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\uff0c\u4efb\u4f55\u4e0d\u7b26\u5408\u8981\u6c42\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"age"),"\u5c5e\u6027\u8d4b\u503c\uff0c\u90fd\u4f1a\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\uff0c\u8fd9\u662f\u6570\u636e\u9a8c\u8bc1\u7684\u4e00\u79cd\u5b9e\u73b0\u65b9\u6cd5\u3002\u5229\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u65b9\u6cd5\uff0c\u8fd8\u53ef\u4ee5\u6570\u636e\u7ed1\u5b9a\uff0c\u5373\u6bcf\u5f53\u5bf9\u8c61\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u4f1a\u81ea\u52a8\u66f4\u65b0 DOM\u3002"),(0,a.kt)("p",null,"\u6709\u65f6\uff0c\u6211\u4eec\u4f1a\u5728\u5bf9\u8c61\u4e0a\u9762\u8bbe\u7f6e\u5185\u90e8\u5c5e\u6027\uff0c\u5c5e\u6027\u540d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4f7f\u7528\u4e0b\u5212\u7ebf\u5f00\u5934\uff0c\u8868\u793a\u8fd9\u4e9b\u5c5e\u6027\u4e0d\u5e94\u8be5\u88ab\u5916\u90e8\u4f7f\u7528\u3002\u7ed3\u5408",(0,a.kt)("inlineCode",{parentName:"p"},"get"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u9632\u6b62\u8fd9\u4e9b\u5185\u90e8\u5c5e\u6027\u88ab\u5916\u90e8\u8bfb\u5199\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const handler = {\n  get (target, key) {\n    invariant(key, 'get');\n    return target[key];\n  },\n  set (target, key, value) {\n    invariant(key, 'set');\n    target[key] = value;\n    return true;\n  }\n};\nfunction invariant (key, action) {\n  if (key[0] === '_') {\n    throw new Error(`Invalid attempt to ${action} private \"${key}\" property`);\n  }\n}\nconst target = {};\nconst proxy = new Proxy(target, handler);\nproxy._prop\n// Error: Invalid attempt to get private \"_prop\" property\nproxy._prop = 'c'\n// Error: Invalid attempt to set private \"_prop\" property\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u53ea\u8981\u8bfb\u5199\u7684\u5c5e\u6027\u540d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0b\u5212\u7ebf\uff0c\u4e00\u5f8b\u629b\u9519\uff0c\u4ece\u800c\u8fbe\u5230\u7981\u6b62\u8bfb\u5199\u5185\u90e8\u5c5e\u6027\u7684\u76ee\u7684\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u65b9\u6cd5\u7b2c\u56db\u4e2a\u53c2\u6570\u7684\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = receiver;\n    return true;\n  }\n};\nconst proxy = new Proxy({}, handler);\nproxy.foo = 'bar';\nproxy.foo === proxy // true\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u65b9\u6cd5\u7684\u7b2c\u56db\u4e2a\u53c2\u6570",(0,a.kt)("inlineCode",{parentName:"p"},"receiver"),"\uff0c\u6307\u7684\u662f\u539f\u59cb\u7684\u64cd\u4f5c\u884c\u4e3a\u6240\u5728\u7684\u90a3\u4e2a\u5bf9\u8c61\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u5b9e\u4f8b\u672c\u8eab\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = receiver;\n    return true;\n  }\n};\nconst proxy = new Proxy({}, handler);\nconst myObj = {};\nObject.setPrototypeOf(myObj, proxy);\n\nmyObj.foo = 'bar';\nmyObj.foo === myObj // true\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u8bbe\u7f6e",(0,a.kt)("inlineCode",{parentName:"p"},"myObj.foo"),"\u5c5e\u6027\u7684\u503c\u65f6\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"myObj"),"\u5e76\u6ca1\u6709",(0,a.kt)("inlineCode",{parentName:"p"},"foo"),"\u5c5e\u6027\uff0c\u56e0\u6b64\u5f15\u64ce\u4f1a\u5230",(0,a.kt)("inlineCode",{parentName:"p"},"myObj"),"\u7684\u539f\u578b\u94fe\u53bb\u627e",(0,a.kt)("inlineCode",{parentName:"p"},"foo"),"\u5c5e\u6027\u3002",(0,a.kt)("inlineCode",{parentName:"p"},"myObj"),"\u7684\u539f\u578b\u5bf9\u8c61",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u662f\u4e00\u4e2a Proxy \u5b9e\u4f8b\uff0c\u8bbe\u7f6e\u5b83\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"foo"),"\u5c5e\u6027\u4f1a\u89e6\u53d1",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u65b9\u6cd5\u3002\u8fd9\u65f6\uff0c\u7b2c\u56db\u4e2a\u53c2\u6570",(0,a.kt)("inlineCode",{parentName:"p"},"receiver"),"\u5c31\u6307\u5411\u539f\u59cb\u8d4b\u503c\u884c\u4e3a\u6240\u5728\u7684\u5bf9\u8c61",(0,a.kt)("inlineCode",{parentName:"p"},"myObj"),"\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u81ea\u8eab\u7684\u67d0\u4e2a\u5c5e\u6027\u4e0d\u53ef\u5199\uff0c\u90a3\u4e48",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u65b9\u6cd5\u5c06\u4e0d\u8d77\u4f5c\u7528\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const obj = {};\nObject.defineProperty(obj, 'foo', {\n  value: 'bar',\n  writable: false\n});\n\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = 'baz';\n    return true;\n  }\n};\n\nconst proxy = new Proxy(obj, handler);\nproxy.foo = 'baz';\nproxy.foo // \"bar\"\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"obj.foo"),"\u5c5e\u6027\u4e0d\u53ef\u5199\uff0cProxy \u5bf9\u8fd9\u4e2a\u5c5e\u6027\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u4ee3\u7406\u5c06\u4e0d\u4f1a\u751f\u6548\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u4ee3\u7406\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002\u4e25\u683c\u6a21\u5f0f\u4e0b\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u4ee3\u7406\u5982\u679c\u6ca1\u6709\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"true"),"\uff0c\u5c31\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"'use strict';\nconst handler = {\n  set: function(obj, prop, value, receiver) {\n    obj[prop] = receiver;\n    // \u65e0\u8bba\u6709\u6ca1\u6709\u4e0b\u9762\u8fd9\u4e00\u884c\uff0c\u90fd\u4f1a\u62a5\u9519\n    return false;\n  }\n};\nconst proxy = new Proxy({}, handler);\nproxy.foo = 'bar';\n// TypeError: 'set' on proxy: trap returned falsish for property 'foo'\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u4e25\u683c\u6a21\u5f0f\u4e0b\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"\u4ee3\u7406\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"false"),"\u6216\u8005",(0,a.kt)("inlineCode",{parentName:"p"},"undefined"),"\uff0c\u90fd\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("h3",{id:"apply"},"apply()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"apply"),"\u65b9\u6cd5\u62e6\u622a\u51fd\u6570\u7684\u8c03\u7528\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"call"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"apply"),"\u64cd\u4f5c\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"apply"),"\u65b9\u6cd5\u53ef\u4ee5\u63a5\u53d7\u4e09\u4e2a\u53c2\u6570\uff0c\u5206\u522b\u662f\u76ee\u6807\u5bf9\u8c61\u3001\u76ee\u6807\u5bf9\u8c61\u7684\u4e0a\u4e0b\u6587\u5bf9\u8c61\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\uff09\u548c\u76ee\u6807\u5bf9\u8c61\u7684\u53c2\u6570\u6570\u7ec4\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var handler = {\n  apply (target, ctx, args) {\n    return Reflect.apply(...arguments);\n  }\n};\n")),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var target = function () { return 'I am the target'; };\nvar handler = {\n  apply: function () {\n    return 'I am the proxy';\n  }\n};\n\nvar p = new Proxy(target, handler);\n\np()\n// \"I am the proxy\"\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u53d8\u91cf",(0,a.kt)("inlineCode",{parentName:"p"},"p"),"\u662f Proxy \u7684\u5b9e\u4f8b\uff0c\u5f53\u5b83\u4f5c\u4e3a\u51fd\u6570\u8c03\u7528\u65f6\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"p()"),"\uff09\uff0c\u5c31\u4f1a\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"apply"),"\u65b9\u6cd5\u62e6\u622a\uff0c\u8fd4\u56de\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u53e6\u5916\u4e00\u4e2a\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var twice = {\n  apply (target, ctx, args) {\n    return Reflect.apply(...arguments) * 2;\n  }\n};\nfunction sum (left, right) {\n  return left + right;\n};\nvar proxy = new Proxy(sum, twice);\nproxy(1, 2) // 6\nproxy.call(null, 5, 6) // 22\nproxy.apply(null, [7, 8]) // 30\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u6bcf\u5f53\u6267\u884c",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u51fd\u6570\uff08\u76f4\u63a5\u8c03\u7528\u6216",(0,a.kt)("inlineCode",{parentName:"p"},"call"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"apply"),"\u8c03\u7528\uff09\uff0c\u5c31\u4f1a\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"apply"),"\u65b9\u6cd5\u62e6\u622a\u3002"),(0,a.kt)("p",null,"\u53e6\u5916\uff0c\u76f4\u63a5\u8c03\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"Reflect.apply"),"\u65b9\u6cd5\uff0c\u4e5f\u4f1a\u88ab\u62e6\u622a\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"Reflect.apply(proxy, null, [9, 10]) // 38\n")),(0,a.kt)("h3",{id:"has"},"has()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"has()"),"\u65b9\u6cd5\u7528\u6765\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"HasProperty"),"\u64cd\u4f5c\uff0c\u5373\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u5177\u6709\u67d0\u4e2a\u5c5e\u6027\u65f6\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u751f\u6548\u3002\u5178\u578b\u7684\u64cd\u4f5c\u5c31\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"in"),"\u8fd0\u7b97\u7b26\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"has()"),"\u65b9\u6cd5\u53ef\u4ee5\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff0c\u5206\u522b\u662f\u76ee\u6807\u5bf9\u8c61\u3001\u9700\u67e5\u8be2\u7684\u5c5e\u6027\u540d\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u7684\u4f8b\u5b50\u4f7f\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"has()"),"\u65b9\u6cd5\u9690\u85cf\u67d0\u4e9b\u5c5e\u6027\uff0c\u4e0d\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"in"),"\u8fd0\u7b97\u7b26\u53d1\u73b0\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var handler = {\n  has (target, key) {\n    if (key[0] === '_') {\n      return false;\n    }\n    return key in target;\n  }\n};\nvar target = { _prop: 'foo', prop: 'foo' };\nvar proxy = new Proxy(target, handler);\n'_prop' in proxy // false\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u5982\u679c\u539f\u5bf9\u8c61\u7684\u5c5e\u6027\u540d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0b\u5212\u7ebf\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"proxy.has()"),"\u5c31\u4f1a\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"false"),"\uff0c\u4ece\u800c\u4e0d\u4f1a\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"in"),"\u8fd0\u7b97\u7b26\u53d1\u73b0\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u539f\u5bf9\u8c61\u4e0d\u53ef\u914d\u7f6e\u6216\u8005\u7981\u6b62\u6269\u5c55\uff0c\u8fd9\u65f6",(0,a.kt)("inlineCode",{parentName:"p"},"has()"),"\u62e6\u622a\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var obj = { a: 10 };\nObject.preventExtensions(obj);\n\nvar p = new Proxy(obj, {\n  has: function(target, prop) {\n    return false;\n  }\n});\n\n'a' in p // TypeError is thrown\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"obj"),"\u5bf9\u8c61\u7981\u6b62\u6269\u5c55\uff0c\u7ed3\u679c\u4f7f\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"has"),"\u62e6\u622a\u5c31\u4f1a\u62a5\u9519\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u67d0\u4e2a\u5c5e\u6027\u4e0d\u53ef\u914d\u7f6e\uff08\u6216\u8005\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\uff09\uff0c\u5219",(0,a.kt)("inlineCode",{parentName:"p"},"has()"),"\u65b9\u6cd5\u5c31\u4e0d\u5f97\u201c\u9690\u85cf\u201d\uff08\u5373\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"false"),"\uff09\u76ee\u6807\u5bf9\u8c61\u7684\u8be5\u5c5e\u6027\u3002"),(0,a.kt)("p",null,"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"has()"),"\u65b9\u6cd5\u62e6\u622a\u7684\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"HasProperty"),"\u64cd\u4f5c\uff0c\u800c\u4e0d\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"HasOwnProperty"),"\u64cd\u4f5c\uff0c\u5373",(0,a.kt)("inlineCode",{parentName:"p"},"has()"),"\u65b9\u6cd5\u4e0d\u5224\u65ad\u4e00\u4e2a\u5c5e\u6027\u662f\u5bf9\u8c61\u81ea\u8eab\u7684\u5c5e\u6027\uff0c\u8fd8\u662f\u7ee7\u627f\u7684\u5c5e\u6027\u3002"),(0,a.kt)("p",null,"\u53e6\u5916\uff0c\u867d\u7136",(0,a.kt)("inlineCode",{parentName:"p"},"for...in"),"\u5faa\u73af\u4e5f\u7528\u5230\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"in"),"\u8fd0\u7b97\u7b26\uff0c\u4f46\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"has()"),"\u62e6\u622a\u5bf9",(0,a.kt)("inlineCode",{parentName:"p"},"for...in"),"\u5faa\u73af\u4e0d\u751f\u6548\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"let stu1 = {name: '\u5f20\u4e09', score: 59};\nlet stu2 = {name: '\u674e\u56db', score: 99};\n\nlet handler = {\n  has(target, prop) {\n    if (prop === 'score' && target[prop] < 60) {\n      console.log(`${target.name} \u4e0d\u53ca\u683c`);\n      return false;\n    }\n    return prop in target;\n  }\n}\n\nlet oproxy1 = new Proxy(stu1, handler);\nlet oproxy2 = new Proxy(stu2, handler);\n\n'score' in oproxy1\n// \u5f20\u4e09 \u4e0d\u53ca\u683c\n// false\n\n'score' in oproxy2\n// true\n\nfor (let a in oproxy1) {\n  console.log(oproxy1[a]);\n}\n// \u5f20\u4e09\n// 59\n\nfor (let b in oproxy2) {\n  console.log(oproxy2[b]);\n}\n// \u674e\u56db\n// 99\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"has()"),"\u62e6\u622a\u53ea\u5bf9",(0,a.kt)("inlineCode",{parentName:"p"},"in"),"\u8fd0\u7b97\u7b26\u751f\u6548\uff0c\u5bf9",(0,a.kt)("inlineCode",{parentName:"p"},"for...in"),"\u5faa\u73af\u4e0d\u751f\u6548\uff0c\u5bfc\u81f4\u4e0d\u7b26\u5408\u8981\u6c42\u7684\u5c5e\u6027\u6ca1\u6709\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"for...in"),"\u5faa\u73af\u6240\u6392\u9664\u3002"),(0,a.kt)("h3",{id:"construct"},"construct()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"construct()"),"\u65b9\u6cd5\u7528\u4e8e\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"new"),"\u547d\u4ee4\uff0c\u4e0b\u9762\u662f\u62e6\u622a\u5bf9\u8c61\u7684\u5199\u6cd5\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const handler = {\n  construct (target, args, newTarget) {\n    return new target(...args);\n  }\n};\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"construct()"),"\u65b9\u6cd5\u53ef\u4ee5\u63a5\u53d7\u4e09\u4e2a\u53c2\u6570\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"target"),"\uff1a\u76ee\u6807\u5bf9\u8c61\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"args"),"\uff1a\u6784\u9020\u51fd\u6570\u7684\u53c2\u6570\u6570\u7ec4\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"newTarget"),"\uff1a\u521b\u9020\u5b9e\u4f8b\u5bf9\u8c61\u65f6\uff0c",(0,a.kt)("inlineCode",{parentName:"li"},"new"),"\u547d\u4ee4\u4f5c\u7528\u7684\u6784\u9020\u51fd\u6570\uff08\u4e0b\u9762\u4f8b\u5b50\u7684",(0,a.kt)("inlineCode",{parentName:"li"},"p"),"\uff09\u3002")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const p = new Proxy(function () {}, {\n  construct: function(target, args) {\n    console.log('called: ' + args.join(', '));\n    return { value: args[0] * 10 };\n  }\n});\n\n(new p(1)).value\n// \"called: 1\"\n// 10\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"construct()"),"\u65b9\u6cd5\u8fd4\u56de\u7684\u5fc5\u987b\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const p = new Proxy(function() {}, {\n  construct: function(target, argumentsList) {\n    return 1;\n  }\n});\n\nnew p() // \u62a5\u9519\n// Uncaught TypeError: 'construct' on proxy: trap returned non-object ('1')\n")),(0,a.kt)("p",null,"\u53e6\u5916\uff0c\u7531\u4e8e",(0,a.kt)("inlineCode",{parentName:"p"},"construct()"),"\u62e6\u622a\u7684\u662f\u6784\u9020\u51fd\u6570\uff0c\u6240\u4ee5\u5b83\u7684\u76ee\u6807\u5bf9\u8c61\u5fc5\u987b\u662f\u51fd\u6570\uff0c\u5426\u5219\u5c31\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const p = new Proxy({}, {\n  construct: function(target, argumentsList) {\n    return {};\n  }\n});\n\nnew p() // \u62a5\u9519\n// Uncaught TypeError: p is not a constructor\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u62e6\u622a\u7684\u76ee\u6807\u5bf9\u8c61\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u800c\u662f\u4e00\u4e2a\u5bf9\u8c61\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"new Proxy()"),"\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff09\uff0c\u5bfc\u81f4\u62a5\u9519\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"construct()"),"\u65b9\u6cd5\u4e2d\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\u6307\u5411\u7684\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"handler"),"\uff0c\u800c\u4e0d\u662f\u5b9e\u4f8b\u5bf9\u8c61\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const handler = {\n  construct: function(target, args) {\n    console.log(this === handler);\n    return new target(...args);\n  }\n}\n\nlet p = new Proxy(function () {}, handler);\nnew p() // true\n")),(0,a.kt)("h3",{id:"deleteproperty"},"deleteProperty()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"deleteProperty"),"\u65b9\u6cd5\u7528\u4e8e\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"delete"),"\u64cd\u4f5c\uff0c\u5982\u679c\u8fd9\u4e2a\u65b9\u6cd5\u629b\u51fa\u9519\u8bef\u6216\u8005\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"false"),"\uff0c\u5f53\u524d\u5c5e\u6027\u5c31\u65e0\u6cd5\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"delete"),"\u547d\u4ee4\u5220\u9664\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var handler = {\n  deleteProperty (target, key) {\n    invariant(key, 'delete');\n    delete target[key];\n    return true;\n  }\n};\nfunction invariant (key, action) {\n  if (key[0] === '_') {\n    throw new Error(`Invalid attempt to ${action} private \"${key}\" property`);\n  }\n}\n\nvar target = { _prop: 'foo' };\nvar proxy = new Proxy(target, handler);\ndelete proxy._prop\n// Error: Invalid attempt to delete private \"_prop\" property\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"deleteProperty"),"\u65b9\u6cd5\u62e6\u622a\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"delete"),"\u64cd\u4f5c\u7b26\uff0c\u5220\u9664\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e3a\u4e0b\u5212\u7ebf\u7684\u5c5e\u6027\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c\u76ee\u6807\u5bf9\u8c61\u81ea\u8eab\u7684\u4e0d\u53ef\u914d\u7f6e\uff08configurable\uff09\u7684\u5c5e\u6027\uff0c\u4e0d\u80fd\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"deleteProperty"),"\u65b9\u6cd5\u5220\u9664\uff0c\u5426\u5219\u62a5\u9519\u3002"),(0,a.kt)("h3",{id:"defineproperty"},"defineProperty()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"defineProperty()"),"\u65b9\u6cd5\u62e6\u622a\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"Object.defineProperty()"),"\u64cd\u4f5c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var handler = {\n  defineProperty (target, key, descriptor) {\n    return false;\n  }\n};\nvar target = {};\nvar proxy = new Proxy(target, handler);\nproxy.foo = 'bar' // \u4e0d\u4f1a\u751f\u6548\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"defineProperty()"),"\u65b9\u6cd5\u5185\u90e8\u6ca1\u6709\u4efb\u4f55\u64cd\u4f5c\uff0c\u53ea\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"false"),"\uff0c\u5bfc\u81f4\u6dfb\u52a0\u65b0\u5c5e\u6027\u603b\u662f\u65e0\u6548\u3002\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"false"),"\u53ea\u662f\u7528\u6765\u63d0\u793a\u64cd\u4f5c\u5931\u8d25\uff0c\u672c\u8eab\u5e76\u4e0d\u80fd\u963b\u6b62\u6dfb\u52a0\u65b0\u5c5e\u6027\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\uff08non-extensible\uff09\uff0c\u5219",(0,a.kt)("inlineCode",{parentName:"p"},"defineProperty()"),"\u4e0d\u80fd\u589e\u52a0\u76ee\u6807\u5bf9\u8c61\u4e0a\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002\u53e6\u5916\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u7684\u67d0\u4e2a\u5c5e\u6027\u4e0d\u53ef\u5199\uff08writable\uff09\u6216\u4e0d\u53ef\u914d\u7f6e\uff08configurable\uff09\uff0c\u5219",(0,a.kt)("inlineCode",{parentName:"p"},"defineProperty()"),"\u65b9\u6cd5\u4e0d\u5f97\u6539\u53d8\u8fd9\u4e24\u4e2a\u8bbe\u7f6e\u3002"),(0,a.kt)("h3",{id:"getownpropertydescriptor"},"getOwnPropertyDescriptor()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"getOwnPropertyDescriptor()"),"\u65b9\u6cd5\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"Object.getOwnPropertyDescriptor()"),"\uff0c\u8fd4\u56de\u4e00\u4e2a\u5c5e\u6027\u63cf\u8ff0\u5bf9\u8c61\u6216\u8005",(0,a.kt)("inlineCode",{parentName:"p"},"undefined"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var handler = {\n  getOwnPropertyDescriptor (target, key) {\n    if (key[0] === '_') {\n      return;\n    }\n    return Object.getOwnPropertyDescriptor(target, key);\n  }\n};\nvar target = { _foo: 'bar', baz: 'tar' };\nvar proxy = new Proxy(target, handler);\nObject.getOwnPropertyDescriptor(proxy, 'wat')\n// undefined\nObject.getOwnPropertyDescriptor(proxy, '_foo')\n// undefined\nObject.getOwnPropertyDescriptor(proxy, 'baz')\n// { value: 'tar', writable: true, enumerable: true, configurable: true }\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"handler.getOwnPropertyDescriptor()"),"\u65b9\u6cd5\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e3a\u4e0b\u5212\u7ebf\u7684\u5c5e\u6027\u540d\u4f1a\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"undefined"),"\u3002"),(0,a.kt)("h3",{id:"getprototypeof"},"getPrototypeOf()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"getPrototypeOf()"),"\u65b9\u6cd5\u4e3b\u8981\u7528\u6765\u62e6\u622a\u83b7\u53d6\u5bf9\u8c61\u539f\u578b\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u62e6\u622a\u4e0b\u9762\u8fd9\u4e9b\u64cd\u4f5c\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Object.prototype.__proto__")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Object.prototype.isPrototypeOf()")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Object.getPrototypeOf()")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Reflect.getPrototypeOf()")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instanceof"))),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var proto = {};\nvar p = new Proxy({}, {\n  getPrototypeOf(target) {\n    return proto;\n  }\n});\nObject.getPrototypeOf(p) === proto // true\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"getPrototypeOf()"),"\u65b9\u6cd5\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"Object.getPrototypeOf()"),"\uff0c\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"proto"),"\u5bf9\u8c61\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"getPrototypeOf()"),"\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u5fc5\u987b\u662f\u5bf9\u8c61\u6216\u8005",(0,a.kt)("inlineCode",{parentName:"p"},"null"),"\uff0c\u5426\u5219\u62a5\u9519\u3002\u53e6\u5916\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\uff08non-extensible\uff09\uff0c ",(0,a.kt)("inlineCode",{parentName:"p"},"getPrototypeOf()"),"\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u76ee\u6807\u5bf9\u8c61\u7684\u539f\u578b\u5bf9\u8c61\u3002"),(0,a.kt)("h3",{id:"isextensible"},"isExtensible()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"isExtensible()"),"\u65b9\u6cd5\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"Object.isExtensible()"),"\u64cd\u4f5c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'var p = new Proxy({}, {\n  isExtensible: function(target) {\n    console.log("called");\n    return true;\n  }\n});\n\nObject.isExtensible(p)\n// "called"\n// true\n')),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u8bbe\u7f6e\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"isExtensible()"),"\u65b9\u6cd5\uff0c\u5728\u8c03\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"Object.isExtensible"),"\u65f6\u4f1a\u8f93\u51fa",(0,a.kt)("inlineCode",{parentName:"p"},"called"),"\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c\u8be5\u65b9\u6cd5\u53ea\u80fd\u8fd4\u56de\u5e03\u5c14\u503c\uff0c\u5426\u5219\u8fd4\u56de\u503c\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e3a\u5e03\u5c14\u503c\u3002"),(0,a.kt)("p",null,"\u8fd9\u4e2a\u65b9\u6cd5\u6709\u4e00\u4e2a\u5f3a\u9650\u5236\uff0c\u5b83\u7684\u8fd4\u56de\u503c\u5fc5\u987b\u4e0e\u76ee\u6807\u5bf9\u8c61\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"isExtensible"),"\u5c5e\u6027\u4fdd\u6301\u4e00\u81f4\uff0c\u5426\u5219\u5c31\u4f1a\u629b\u51fa\u9519\u8bef\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"Object.isExtensible(proxy) === Object.isExtensible(target)\n")),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var p = new Proxy({}, {\n  isExtensible: function(target) {\n    return false;\n  }\n});\n\nObject.isExtensible(p)\n// Uncaught TypeError: 'isExtensible' on proxy: trap result does not reflect extensibility of proxy target (which is 'true')\n")),(0,a.kt)("h3",{id:"ownkeys"},"ownKeys()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u7528\u6765\u62e6\u622a\u5bf9\u8c61\u81ea\u8eab\u5c5e\u6027\u7684\u8bfb\u53d6\u64cd\u4f5c\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u62e6\u622a\u4ee5\u4e0b\u64cd\u4f5c\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Object.getOwnPropertyNames()")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Object.getOwnPropertySymbols()")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Object.keys()")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"for...in"),"\u5faa\u73af")),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"Object.keys()"),"\u7684\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"let target = {\n  a: 1,\n  b: 2,\n  c: 3\n};\n\nlet handler = {\n  ownKeys(target) {\n    return ['a'];\n  }\n};\n\nlet proxy = new Proxy(target, handler);\n\nObject.keys(proxy)\n// [ 'a' ]\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u62e6\u622a\u4e86\u5bf9\u4e8e",(0,a.kt)("inlineCode",{parentName:"p"},"target"),"\u5bf9\u8c61\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"Object.keys()"),"\u64cd\u4f5c\uff0c\u53ea\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"a"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"b"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"c"),"\u4e09\u4e2a\u5c5e\u6027\u4e4b\u4e2d\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"a"),"\u5c5e\u6027\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u7684\u4f8b\u5b50\u662f\u62e6\u622a\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e3a\u4e0b\u5212\u7ebf\u7684\u5c5e\u6027\u540d\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"let target = {\n  _bar: 'foo',\n  _prop: 'bar',\n  prop: 'baz'\n};\n\nlet handler = {\n  ownKeys (target) {\n    return Reflect.ownKeys(target).filter(key => key[0] !== '_');\n  }\n};\n\nlet proxy = new Proxy(target, handler);\nfor (let key of Object.keys(proxy)) {\n  console.log(target[key]);\n}\n// \"baz\"\n")),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c\u4f7f\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"Object.keys()"),"\u65b9\u6cd5\u65f6\uff0c\u6709\u4e09\u7c7b\u5c5e\u6027\u4f1a\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u81ea\u52a8\u8fc7\u6ee4\uff0c\u4e0d\u4f1a\u8fd4\u56de\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u76ee\u6807\u5bf9\u8c61\u4e0a\u4e0d\u5b58\u5728\u7684\u5c5e\u6027"),(0,a.kt)("li",{parentName:"ul"},"\u5c5e\u6027\u540d\u4e3a Symbol \u503c"),(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u53ef\u904d\u5386\uff08",(0,a.kt)("inlineCode",{parentName:"li"},"enumerable"),"\uff09\u7684\u5c5e\u6027")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"let target = {\n  a: 1,\n  b: 2,\n  c: 3,\n  [Symbol.for('secret')]: '4',\n};\n\nObject.defineProperty(target, 'key', {\n  enumerable: false,\n  configurable: true,\n  writable: true,\n  value: 'static'\n});\n\nlet handler = {\n  ownKeys(target) {\n    return ['a', 'd', Symbol.for('secret'), 'key'];\n  }\n};\n\nlet proxy = new Proxy(target, handler);\n\nObject.keys(proxy)\n// ['a']\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u4e4b\u4e2d\uff0c\u663e\u5f0f\u8fd4\u56de\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"d"),"\uff09\u3001Symbol \u503c\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"Symbol.for('secret')"),"\uff09\u3001\u4e0d\u53ef\u904d\u5386\u7684\u5c5e\u6027\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"key"),"\uff09\uff0c\u7ed3\u679c\u90fd\u88ab\u81ea\u52a8\u8fc7\u6ee4\u6389\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u8fd8\u53ef\u4ee5\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"Object.getOwnPropertyNames()"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var p = new Proxy({}, {\n  ownKeys: function(target) {\n    return ['a', 'b', 'c'];\n  }\n});\n\nObject.getOwnPropertyNames(p)\n// [ 'a', 'b', 'c' ]\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"for...in"),"\u5faa\u73af\u4e5f\u53d7\u5230",(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u7684\u62e6\u622a\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const obj = { hello: 'world' };\nconst proxy = new Proxy(obj, {\n  ownKeys: function () {\n    return ['a', 'b'];\n  }\n});\n\nfor (let key in proxy) {\n  console.log(key); // \u6ca1\u6709\u4efb\u4f55\u8f93\u51fa\n}\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"ownkeys()"),"\u6307\u5b9a\u53ea\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"a"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"b"),"\u5c5e\u6027\uff0c\u7531\u4e8e",(0,a.kt)("inlineCode",{parentName:"p"},"obj"),"\u6ca1\u6709\u8fd9\u4e24\u4e2a\u5c5e\u6027\uff0c\u56e0\u6b64",(0,a.kt)("inlineCode",{parentName:"p"},"for...in"),"\u5faa\u73af\u4e0d\u4f1a\u6709\u4efb\u4f55\u8f93\u51fa\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u8fd4\u56de\u7684\u6570\u7ec4\u6210\u5458\uff0c\u53ea\u80fd\u662f\u5b57\u7b26\u4e32\u6216 Symbol \u503c\u3002\u5982\u679c\u6709\u5176\u4ed6\u7c7b\u578b\u7684\u503c\uff0c\u6216\u8005\u8fd4\u56de\u7684\u6839\u672c\u4e0d\u662f\u6570\u7ec4\uff0c\u5c31\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var obj = {};\n\nvar p = new Proxy(obj, {\n  ownKeys: function(target) {\n    return [123, true, undefined, null, {}, []];\n  }\n});\n\nObject.getOwnPropertyNames(p)\n// Uncaught TypeError: 123 is not a valid property name\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u867d\u7136\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\uff0c\u4f46\u662f\u6bcf\u4e00\u4e2a\u6570\u7ec4\u6210\u5458\u90fd\u4e0d\u662f\u5b57\u7b26\u4e32\u6216 Symbol \u503c\uff0c\u56e0\u6b64\u5c31\u62a5\u9519\u4e86\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u81ea\u8eab\u5305\u542b\u4e0d\u53ef\u914d\u7f6e\u7684\u5c5e\u6027\uff0c\u5219\u8be5\u5c5e\u6027\u5fc5\u987b\u88ab",(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u8fd4\u56de\uff0c\u5426\u5219\u62a5\u9519\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var obj = {};\nObject.defineProperty(obj, 'a', {\n  configurable: false,\n  enumerable: true,\n  value: 10 }\n);\n\nvar p = new Proxy(obj, {\n  ownKeys: function(target) {\n    return ['b'];\n  }\n});\n\nObject.getOwnPropertyNames(p)\n// Uncaught TypeError: 'ownKeys' on proxy: trap result did not include 'a'\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"obj"),"\u5bf9\u8c61\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"a"),"\u5c5e\u6027\u662f\u4e0d\u53ef\u914d\u7f6e\u7684\uff0c\u8fd9\u65f6",(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u8fd4\u56de\u7684\u6570\u7ec4\u4e4b\u4e2d\uff0c\u5fc5\u987b\u5305\u542b",(0,a.kt)("inlineCode",{parentName:"p"},"a"),"\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("p",null,"\u53e6\u5916\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u662f\u4e0d\u53ef\u6269\u5c55\u7684\uff08non-extensible\uff09\uff0c\u8fd9\u65f6",(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u8fd4\u56de\u7684\u6570\u7ec4\u4e4b\u4e2d\uff0c\u5fc5\u987b\u5305\u542b\u539f\u5bf9\u8c61\u7684\u6240\u6709\u5c5e\u6027\uff0c\u4e14\u4e0d\u80fd\u5305\u542b\u591a\u4f59\u7684\u5c5e\u6027\uff0c\u5426\u5219\u62a5\u9519\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var obj = {\n  a: 1\n};\n\nObject.preventExtensions(obj);\n\nvar p = new Proxy(obj, {\n  ownKeys: function(target) {\n    return ['a', 'b'];\n  }\n});\n\nObject.getOwnPropertyNames(p)\n// Uncaught TypeError: 'ownKeys' on proxy: trap returned extra keys but proxy target is non-extensible\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"obj"),"\u5bf9\u8c61\u662f\u4e0d\u53ef\u6269\u5c55\u7684\uff0c\u8fd9\u65f6",(0,a.kt)("inlineCode",{parentName:"p"},"ownKeys()"),"\u65b9\u6cd5\u8fd4\u56de\u7684\u6570\u7ec4\u4e4b\u4e2d\uff0c\u5305\u542b\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"obj"),"\u5bf9\u8c61\u7684\u591a\u4f59\u5c5e\u6027",(0,a.kt)("inlineCode",{parentName:"p"},"b"),"\uff0c\u6240\u4ee5\u5bfc\u81f4\u4e86\u62a5\u9519\u3002"),(0,a.kt)("h3",{id:"preventextensions"},"preventExtensions()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"preventExtensions()"),"\u65b9\u6cd5\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"Object.preventExtensions()"),"\u3002\u8be5\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u5426\u5219\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e3a\u5e03\u5c14\u503c\u3002"),(0,a.kt)("p",null,"\u8fd9\u4e2a\u65b9\u6cd5\u6709\u4e00\u4e2a\u9650\u5236\uff0c\u53ea\u6709\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\u65f6\uff08\u5373",(0,a.kt)("inlineCode",{parentName:"p"},"Object.isExtensible(proxy)"),"\u4e3a",(0,a.kt)("inlineCode",{parentName:"p"},"false"),"\uff09\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"proxy.preventExtensions"),"\u624d\u80fd\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"true"),"\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var proxy = new Proxy({}, {\n  preventExtensions: function(target) {\n    return true;\n  }\n});\n\nObject.preventExtensions(proxy)\n// Uncaught TypeError: 'preventExtensions' on proxy: trap returned truish but the proxy target is extensible\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"proxy.preventExtensions()"),"\u65b9\u6cd5\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"true"),"\uff0c\u4f46\u8fd9\u65f6",(0,a.kt)("inlineCode",{parentName:"p"},"Object.isExtensible(proxy)"),"\u4f1a\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"true"),"\uff0c\u56e0\u6b64\u62a5\u9519\u3002"),(0,a.kt)("p",null,"\u4e3a\u4e86\u9632\u6b62\u51fa\u73b0\u8fd9\u4e2a\u95ee\u9898\uff0c\u901a\u5e38\u8981\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"proxy.preventExtensions()"),"\u65b9\u6cd5\u91cc\u9762\uff0c\u8c03\u7528\u4e00\u6b21",(0,a.kt)("inlineCode",{parentName:"p"},"Object.preventExtensions()"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var proxy = new Proxy({}, {\n  preventExtensions: function(target) {\n    console.log('called');\n    Object.preventExtensions(target);\n    return true;\n  }\n});\n\nObject.preventExtensions(proxy)\n// \"called\"\n// Proxy {}\n")),(0,a.kt)("h3",{id:"setprototypeof"},"setPrototypeOf()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"setPrototypeOf()"),"\u65b9\u6cd5\u4e3b\u8981\u7528\u6765\u62e6\u622a",(0,a.kt)("inlineCode",{parentName:"p"},"Object.setPrototypeOf()"),"\u65b9\u6cd5\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var handler = {\n  setPrototypeOf (target, proto) {\n    throw new Error('Changing the prototype is forbidden');\n  }\n};\nvar proto = {};\nvar target = function () {};\nvar proxy = new Proxy(target, handler);\nObject.setPrototypeOf(proxy, proto);\n// Error: Changing the prototype is forbidden\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u53ea\u8981\u4fee\u6539",(0,a.kt)("inlineCode",{parentName:"p"},"target"),"\u7684\u539f\u578b\u5bf9\u8c61\uff0c\u5c31\u4f1a\u62a5\u9519\u3002"),(0,a.kt)("p",null,"\u6ce8\u610f\uff0c\u8be5\u65b9\u6cd5\u53ea\u80fd\u8fd4\u56de\u5e03\u5c14\u503c\uff0c\u5426\u5219\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e3a\u5e03\u5c14\u503c\u3002\u53e6\u5916\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\uff08non-extensible\uff09\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"setPrototypeOf()"),"\u65b9\u6cd5\u4e0d\u5f97\u6539\u53d8\u76ee\u6807\u5bf9\u8c61\u7684\u539f\u578b\u3002"),(0,a.kt)("h2",{id:"proxyrevocable"},"Proxy.revocable()"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Proxy.revocable()"),"\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u53ef\u53d6\u6d88\u7684 Proxy \u5b9e\u4f8b\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"let target = {};\nlet handler = {};\n\nlet {proxy, revoke} = Proxy.revocable(target, handler);\n\nproxy.foo = 123;\nproxy.foo // 123\n\nrevoke();\nproxy.foo // TypeError: Revoked\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Proxy.revocable()"),"\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u5c5e\u6027\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"Proxy"),"\u5b9e\u4f8b\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"revoke"),"\u5c5e\u6027\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u53d6\u6d88",(0,a.kt)("inlineCode",{parentName:"p"},"Proxy"),"\u5b9e\u4f8b\u3002\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u5f53\u6267\u884c",(0,a.kt)("inlineCode",{parentName:"p"},"revoke"),"\u51fd\u6570\u4e4b\u540e\uff0c\u518d\u8bbf\u95ee",(0,a.kt)("inlineCode",{parentName:"p"},"Proxy"),"\u5b9e\u4f8b\uff0c\u5c31\u4f1a\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Proxy.revocable()"),"\u7684\u4e00\u4e2a\u4f7f\u7528\u573a\u666f\u662f\uff0c\u76ee\u6807\u5bf9\u8c61\u4e0d\u5141\u8bb8\u76f4\u63a5\u8bbf\u95ee\uff0c\u5fc5\u987b\u901a\u8fc7\u4ee3\u7406\u8bbf\u95ee\uff0c\u4e00\u65e6\u8bbf\u95ee\u7ed3\u675f\uff0c\u5c31\u6536\u56de\u4ee3\u7406\u6743\uff0c\u4e0d\u5141\u8bb8\u518d\u6b21\u8bbf\u95ee\u3002"),(0,a.kt)("h2",{id:"this-\u95ee\u9898"},"this \u95ee\u9898"),(0,a.kt)("p",null,"\u867d\u7136 Proxy \u53ef\u4ee5\u4ee3\u7406\u9488\u5bf9\u76ee\u6807\u5bf9\u8c61\u7684\u8bbf\u95ee\uff0c\u4f46\u5b83\u4e0d\u662f\u76ee\u6807\u5bf9\u8c61\u7684\u900f\u660e\u4ee3\u7406\uff0c\u5373\u4e0d\u505a\u4efb\u4f55\u62e6\u622a\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u65e0\u6cd5\u4fdd\u8bc1\u4e0e\u76ee\u6807\u5bf9\u8c61\u7684\u884c\u4e3a\u4e00\u81f4\u3002\u4e3b\u8981\u539f\u56e0\u5c31\u662f\u5728 Proxy \u4ee3\u7406\u7684\u60c5\u51b5\u4e0b\uff0c\u76ee\u6807\u5bf9\u8c61\u5185\u90e8\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\u5173\u952e\u5b57\u4f1a\u6307\u5411 Proxy \u4ee3\u7406\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const target = {\n  m: function () {\n    console.log(this === proxy);\n  }\n};\nconst handler = {};\n\nconst proxy = new Proxy(target, handler);\n\ntarget.m() // false\nproxy.m()  // true\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u4e00\u65e6",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u4ee3\u7406",(0,a.kt)("inlineCode",{parentName:"p"},"target"),"\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"target.m()"),"\u5185\u90e8\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\u5c31\u662f\u6307\u5411",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\uff0c\u800c\u4e0d\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"target"),"\u3002\u6240\u4ee5\uff0c\u867d\u7136",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\u6ca1\u6709\u505a\u4efb\u4f55\u62e6\u622a\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"target.m()"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"proxy.m()"),"\u8fd4\u56de\u4e0d\u4e00\u6837\u7684\u7ed3\u679c\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u7531\u4e8e",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\u6307\u5411\u7684\u53d8\u5316\uff0c\u5bfc\u81f4 Proxy \u65e0\u6cd5\u4ee3\u7406\u76ee\u6807\u5bf9\u8c61\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const _name = new WeakMap();\n\nclass Person {\n  constructor(name) {\n    _name.set(this, name);\n  }\n  get name() {\n    return _name.get(this);\n  }\n}\n\nconst jane = new Person('Jane');\njane.name // 'Jane'\n\nconst proxy = new Proxy(jane, {});\nproxy.name // undefined\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u76ee\u6807\u5bf9\u8c61",(0,a.kt)("inlineCode",{parentName:"p"},"jane"),"\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"name"),"\u5c5e\u6027\uff0c\u5b9e\u9645\u4fdd\u5b58\u5728\u5916\u90e8",(0,a.kt)("inlineCode",{parentName:"p"},"WeakMap"),"\u5bf9\u8c61",(0,a.kt)("inlineCode",{parentName:"p"},"_name"),"\u4e0a\u9762\uff0c\u901a\u8fc7",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\u952e\u533a\u5206\u3002\u7531\u4e8e\u901a\u8fc7",(0,a.kt)("inlineCode",{parentName:"p"},"proxy.name"),"\u8bbf\u95ee\u65f6\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\u6307\u5411",(0,a.kt)("inlineCode",{parentName:"p"},"proxy"),"\uff0c\u5bfc\u81f4\u65e0\u6cd5\u53d6\u5230\u503c\uff0c\u6240\u4ee5\u8fd4\u56de",(0,a.kt)("inlineCode",{parentName:"p"},"undefined"),"\u3002"),(0,a.kt)("p",null,"\u6b64\u5916\uff0c\u6709\u4e9b\u539f\u751f\u5bf9\u8c61\u7684\u5185\u90e8\u5c5e\u6027\uff0c\u53ea\u6709\u901a\u8fc7\u6b63\u786e\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\u624d\u80fd\u62ff\u5230\uff0c\u6240\u4ee5 Proxy \u4e5f\u65e0\u6cd5\u4ee3\u7406\u8fd9\u4e9b\u539f\u751f\u5bf9\u8c61\u7684\u5c5e\u6027\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const target = new Date();\nconst handler = {};\nconst proxy = new Proxy(target, handler);\n\nproxy.getDate();\n// TypeError: this is not a Date object.\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"getDate()"),"\u65b9\u6cd5\u53ea\u80fd\u5728",(0,a.kt)("inlineCode",{parentName:"p"},"Date"),"\u5bf9\u8c61\u5b9e\u4f8b\u4e0a\u9762\u62ff\u5230\uff0c\u5982\u679c",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\u4e0d\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"Date"),"\u5bf9\u8c61\u5b9e\u4f8b\u5c31\u4f1a\u62a5\u9519\u3002\u8fd9\u65f6\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\u7ed1\u5b9a\u539f\u59cb\u5bf9\u8c61\uff0c\u5c31\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const target = new Date('2015-01-01');\nconst handler = {\n  get(target, prop) {\n    if (prop === 'getDate') {\n      return target.getDate.bind(target);\n    }\n    return Reflect.get(target, prop);\n  }\n};\nconst proxy = new Proxy(target, handler);\n\nproxy.getDate() // 1\n")),(0,a.kt)("p",null,"\u53e6\u5916\uff0cProxy \u62e6\u622a\u51fd\u6570\u5185\u90e8\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\uff0c\u6307\u5411\u7684\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"handler"),"\u5bf9\u8c61\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const handler = {\n  get: function (target, key, receiver) {\n    console.log(this === handler);\n    return 'Hello, ' + key;\n  },\n  set: function (target, key, value) {\n    console.log(this === handler);\n    target[key] = value;\n    return true;\n  }\n};\n\nconst proxy = new Proxy({}, handler);\n\nproxy.foo\n// true\n// Hello, foo\n\nproxy.foo = 1\n// true\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"get()"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"set()"),"\u62e6\u622a\u51fd\u6570\u5185\u90e8\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\uff0c\u6307\u5411\u7684\u90fd\u662f",(0,a.kt)("inlineCode",{parentName:"p"},"handler"),"\u5bf9\u8c61\u3002"),(0,a.kt)("h2",{id:"\u5b9e\u4f8bweb-\u670d\u52a1\u7684\u5ba2\u6237\u7aef"},"\u5b9e\u4f8b\uff1aWeb \u670d\u52a1\u7684\u5ba2\u6237\u7aef"),(0,a.kt)("p",null,"Proxy \u5bf9\u8c61\u53ef\u4ee5\u62e6\u622a\u76ee\u6807\u5bf9\u8c61\u7684\u4efb\u610f\u5c5e\u6027\uff0c\u8fd9\u4f7f\u5f97\u5b83\u5f88\u5408\u9002\u7528\u6765\u5199 Web \u670d\u52a1\u7684\u5ba2\u6237\u7aef\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const service = createWebService('http://example.com/data');\n\nservice.employees().then(json => {\n  const employees = JSON.parse(json);\n  // \xb7\xb7\xb7\n});\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u65b0\u5efa\u4e86\u4e00\u4e2a Web \u670d\u52a1\u7684\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u8fd4\u56de\u5404\u79cd\u6570\u636e\u3002Proxy \u53ef\u4ee5\u62e6\u622a\u8fd9\u4e2a\u5bf9\u8c61\u7684\u4efb\u610f\u5c5e\u6027\uff0c\u6240\u4ee5\u4e0d\u7528\u4e3a\u6bcf\u4e00\u79cd\u6570\u636e\u5199\u4e00\u4e2a\u9002\u914d\u65b9\u6cd5\uff0c\u53ea\u8981\u5199\u4e00\u4e2a Proxy \u62e6\u622a\u5c31\u53ef\u4ee5\u4e86\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"function createWebService(baseUrl) {\n  return new Proxy({}, {\n    get(target, propKey, receiver) {\n      return () => httpGet(baseUrl + '/' + propKey);\n    }\n  });\n}\n")),(0,a.kt)("p",null,"\u540c\u7406\uff0cProxy \u4e5f\u53ef\u4ee5\u7528\u6765\u5b9e\u73b0\u6570\u636e\u5e93\u7684 ORM \u5c42\u3002"))}u.isMDXComponent=!0}}]);